import{L as e,S as t}from"./index.7c3fcde5.js";import{h as s}from"./vendor.b87ee2e0.js";const n=s.compile('<div class="card" data-note-id="{{id}}">\n  <div class="card-header">\n    {{{badges.user}}}\n    {{{badges.age}}}\n    {{{badges.comments}}}\n    {{#list}}{{{badges.country}}}{{/list}}\n    {{{badges.report}}}\n  </div>\n\n  <div class="card-body text-break">\n    {{{comment}}}\n  </div>\n\n  <div class="card-footer">\n    {{#each actions}}\n      {{#if link}}\n      <a class="btn btn-primary btn-sm my-1 {{class}}" href="{{link}}"\n        {{#remote}}target="remote"{{else}}target="_blank" rel="noopener"{{/remote}}>\n        <svg class="icon"><use xlink:href="#icon-{{icon}}"></use></svg>\n        {{text}}\n      </a>\n      {{else}}\n      <button class="btn btn-primary btn-sm my-1 {{class}}">\n        <svg class="icon"><use xlink:href="#icon-{{icon}}"></use></svg>\n        {{text}}\n      </button>\n      {{/if}}\n    {{/each}}\n  </div>\n</div>\n');const r={map:new class{constructor(){this.cluster=L.markerClusterGroup({maxClusterRadius:40}),this.markers=[],this.map=new e("map"),this.map.addLayer(this.cluster)}add(e,s){let n;n=s.data.status===t.ALL?"open"===e.status?"markers/green.svg":"markers/red.svg":`markers/${e.color}.svg`;const r=L.marker(e.coordinates,{icon:new L.divIcon({html:`<img alt="" src="${n}" class="marker-icon comments-modal-trigger" data-note-id="${e.id}">`,iconSize:[25,40],iconAnchor:[12.5,40],popupAnchor:[0,-30],className:"marker-icon"})});this.markers.push(r)}apply(e){this.map.resize(),this.cluster.clearLayers(),this.cluster.addLayers(this.markers),!e&&this.markers.length>0&&this.map.flyToBounds(this.cluster.getBounds(),1),this.markers=[]}},list:new class{constructor(){this.fragment=new DocumentFragment,this.children=[]}add(e){const t=document.createElement("div");t.classList.add("column","col-4","col-md-6","col-sm-12","p-1"),t.innerHTML=n({list:!0,id:e.id,badges:e.badges,comment:e.comments[0].html,actions:e.actions}),this.fragment.appendChild(t)}apply(){const e=document.getElementById("list");for(;e.lastChild;)e.removeChild(e.lastChild);document.getElementById("list").appendChild(this.fragment)}}};export default class{constructor(e){this.notes=[],this.query=null,this.view=e}set view(e){const t=Object.keys(r);if(!t.includes(e))throw new TypeError(`Argument must be one of ${t.join(", ")}`);this._view={name:e,handler:r[e]},this.reload()}get view(){return this._view.name}show(e,t,s){this.query=t,this.notes=e;const n=e.length,r=e.reduce(((e,t)=>e+t.created.getTime()),0)/n;return e.forEach((e=>{this.isNoteVisible(e,t)&&this._view.handler.add(e,t)})),this._view.handler.apply(s),Promise.resolve({amount:n,average:new Date(r)})}isNoteVisible(e,s){return!(s.data.status===t.OPEN&&e.status!==t.OPEN||s.data.status===t.CLOSED&&e.status!==t.CLOSED)}get(e){return this.notes.find((t=>t.id===e))}update(e,t){const s=this.notes.findIndex((t=>t.id===e));if(-1===s)throw new Error(`The note with the id ${e} could not be found in the array`);return this.notes[s]=t,this.reload()}reload(){return this.show(this.notes,this.query,!0)}}
